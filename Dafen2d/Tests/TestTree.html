<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <script src="../dafen2d.onScreenSort.js"></script>
    <script type="text/javascript">

        var tree = dafen2d.createOnScreenTree();
        var makeThing = function() {
            this.screenSort = [];
            var a = 0;
            var i = Math.random() * 4;
            while (a < i) {
                this.screenSort.push(((Math.random() * 200) - 100) | 0);
                a += 1;
            }
        };

        var lastValue = 0;

        makeThing.prototype.draw = function() {
            lastValue += 1;
        };

        var time = 0;
        var times = [];

        var test = function() {
            var now = new Date().getTime();
            var delta = now - (time || now);
            time = now;
            times.push(delta);
            if (times.length == 100) {
                var sum = 0;
                times.forEach(function(delta) {
                    sum += delta;
                });
                console.log(sum / 100);
                times = [];
            }


            var things = [];


            for (var i = 0; i < 1000; i += 1) {
                var thing = new makeThing();
                things.push(thing);
                tree.insert(thing);
            }

            while (things.length > 0) {
                thing = things.pop();
                thing.onScreenNode.remove();
            }

            window.requestAnimationFrame(test);
        };
    </script>
</head>
<body>

</body>
</html>