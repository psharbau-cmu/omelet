!function(){var t={};window.omelet={salt:function(e,r){if(r){var i=r(t);e&&i&&(window.omelet[e]=i)}}}}(),function(){var t=function(t,e){var r=null,i=null,n=null;this.create=function(o,s,a){if(a){if(o=o||{},s=s||{},n&&n.forEach(function(e){return a[e]?void 0:void console.log("Entity missing required component: "+t+" needs "+e)}),r)for(var l in r){if(!s.hasOwnProperty(l)||!s[l])return void console.log("Entity missing needed reference: "+t+" references an entity for "+l+" needing a "+r[l]);if(!s[l][r[l]])return void console.log("Referenced entity missing needed component: "+t+" references an entity for "+l+" that needs a "+r[l])}if(i)for(var l in i)o.hasOwnProperty(l)||(o[l]=i[l]);try{return new e(o,s)}catch(h){console.log("Error calling constructor for type: "+t+" error: "+h)}}},this.references=function(t){return t&&t.constructor===Object||console.log("Error setting references.  Must be non-null object with name -> component types."),r=r||t,this},this.requires=function(t){return t&&t.constructor===Array||console.log("Error setting requirements.  Must be an array of required types for this entity."),n=n||t,this},this.defaults=function(t){return t&&t.constructor===Object||console.log("Error setting defaults.  Must be non-null object with name -> default values."),i=i||t,this}};window.omelet.salt("egg",function(e){var r={};return e.eggs=r,function(e,i){if(e&&i){var n=new t(e,i);return r[e]=n,n}}})}(),function(){var t=function(t){var e=[];e.push(t[3]),e.push(-1*t[1]),e.push(-1*t[2]),e.push(t[0]),e.push(t[2]*t[5]-t[4]*t[3]),e.push(t[4]*t[2]-t[0]*t[5]);for(var r=t[0]*e[0]+t[2]*e[1],i=0;6>i;i+=1)e[i]/=r;return e},e=function(t,e,r){var i=r[0]*t+r[2]*e+r[4],n=r[1]*t+r[3]*e+r[5];return[i,n]},r=function(e,r,i){var n=t(i),o=n[0]*e+n[2]*r+n[4],s=n[1]*e+n[3]*r+n[5];return[o,s]},i=function(t,e,r,i){this.currentMatrix=t.slice(),this.context2d=e,this.parent=r?r.slice():null,this.rect=i};i.prototype.getContext=function(){return this.context2d.setTransform.apply(this.context2d,this.currentMatrix),this.context2d},i.prototype.getIdentityContext=function(){return this.context2d.setTransform(1,0,0,1,0,0),this.context2d},i.prototype.transformPoint=function(t,r){return e(t,r,this.currentMatrix)},i.prototype.inverseTransformPoint=function(t,e){return r(t,e,this.currentMatrix)},i.prototype.inverseTransformInParentSpace=function(t,e){return this.parent?r(t,e,this.parent):[t,e]},i.prototype.getRect=function(){return this.rect||[0,0,0,0]},window.omelet.salt(null,function(t){t.wrapContext=function(t){if(!t||t.constructor!==CanvasRenderingContext2D)return void console.log("Error wrapping context.  Passed context must be of type CanvasRenderingContext2D");var n={matrix:[1,0,0,1,0,0],last:null,rect:null},o=function(t){var e=n.matrix.slice();n.matrix[0]=e[0]*t[0]+e[2]*t[1],n.matrix[1]=e[1]*t[0]+e[3]*t[1],n.matrix[2]=e[0]*t[2]+e[2]*t[3],n.matrix[3]=e[1]*t[2]+e[3]*t[3],n.matrix[4]=e[0]*t[4]+e[2]*t[5]+e[4],n.matrix[5]=e[1]*t[4]+e[3]*t[5]+e[5]};return{save:function(){var t=n.matrix.slice(),e=n.rect?n.rect.slice():null;n={matrix:t,last:n,rect:e}},restore:function(){n.last&&(n=n.last)},scale:function(t,e){o([t,0,0,e,0,0])},rotate:function(t){var e=Math.cos(t),r=Math.sin(t);o([e,r,-1*r,e,0,0])},translate:function(t,e){o([1,0,0,1,t,e])},shear:function(t,e){o([1,e,t,1,0,0])},transform:function(t,e,r,i,n,s){o([t,e,r,i,n,s])},setTransform:function(t,e,r,i,o,s){n.matrix=[t,e,r,i,o,s]},reset:function(){n={matrix:[1,0,0,1,0,0],last:null}},transformPoint:function(t,r){return e(t,r,n.matrix)},inverseTransformPoint:function(t,e){return r(t,e,n.matrix)},getSnapshot:function(){return new i(n.matrix,t,n.last?n.last.matrix:null,n.rect)},setRect:function(t){n.rect=t},getRect:function(t){return n.rect||[0,0,0,0]}}}})}(),function(){var t=function(t,e){t.onScreenNode=this,this.entity=t,this.parent=e};t.prototype.remove=function(){this.entity.onScreenNode=null,this.parent.removeNode(this)};var e=function(t,e){this.key=t,this.parent=e,this.keys=[],this.children={},this.nodes=[]};e.prototype.insert=function(r,i){if(r)if(void 0===i&&(i=r.screenSort?r.screenSort.slice():[0]),i.length<1)this.nodes.push(new t(r,this));else{var n=i.shift();if(!this.children[n]){var o=this.keys;this.keys=[];for(var s=0,a=!1;s<o.length;)!a&&o[s]>n&&(this.keys.push(n),a=!0),this.keys.push(o[s]),s+=1;a||this.keys.push(n),this.children[n]=new e(n,this)}this.children[n].insert(r,i)}},e.prototype.removeNode=function(t){for(var e=0;e<this.nodes.length;){if(this.nodes[e]===t)return this.nodes.splice(e,1),void(this.keys.length<1&&this.nodes.length<1&&this.parent&&this.parent.removeTrie(this.key));e+=1}},e.prototype.removeTrie=function(t){delete this.children[t];for(var e=0;e<this.keys.length;){if(this.keys[e]==t)return this.keys.splice(e,1),void(this.keys.length<1&&this.nodes.length<1&&this.parent&&this.parent.removeTrie(this.key));e+=1}},e.prototype.drawNodes=function(t){this.nodes.forEach(function(e){var r=e.entity.draw();r&&t.push({box:r,entity:e.entity})})},e.prototype.draw=function(t){for(var e=0,r=!1;e<this.keys.length;){var i=this.keys[e];!r&&i>0&&(r=!0,this.drawNodes(t)),this.children[i].draw(t),e+=1}r||this.drawNodes(t)},window.omelet.salt(null,function(t){t.createOnScreenTree=function(){var t=new e;return{insert:function(e){t.insert(e)},draw:function(){var e=[];return t.draw(e),e}}}})}(),function(){window.omelet.salt(null,function(e){e.testIntersection=function(e,r){return t(e,r)&&t(r,e)}});var t=function(t,e){var r,i,n,o,s,a,l=t.length,h=e.length;for(r=0;l>r;r+=1){var c=t[(r+1)%l],u=t[r],f=-1*(c[1]-u[1]),d=c[0]-u[0];for(n=Number.MAX_VALUE,o=Number.MIN_VALUE,i=0;l>i;i+=1){var m=f*t[i][0]+d*t[i][1];n>m&&(n=m),m>o&&(o=m)}for(s=Number.MAX_VALUE,a=Number.MIN_VALUE,i=0;h>i;i+=1){var m=f*e[i][0]+d*e[i][1];s>m&&(s=m),m>a&&(a=m)}if(n>a||s>o)return!1}return!0}}(),function(){var t=function(t,e,r){var i=[r[0]-e[0],r[1]-e[1]],n=[t[0]-e[0],t[1]-e[1]],o=i[0]*n[1]-i[1]*n[0];return 0>o?"L":o>0?"R":"N"};window.omelet.salt(null,function(e){e.testPointInPolygon=function(e,r,i){for(var n=[e,r],o=null,s=0;s<i.length;s+=1){var a=i[(s+1)%i.length],l=i[s],h=t(n,l,a);if("N"==h)return!1;if(o){if(o!=h)return!1}else o=h}return!0}})}(),function(){var t=function(t,e,i){var n=[],o={};return t.forEach(function(t){if(t){var e=new r;e.matchData(t,o)&&n.push(e)}}),n.forEach(function(t){i?t.realize(o,e,i.assets,i.the):t.realize(o,e)}),n},e={components:!0,onScreenNode:!0,screenSort:!0,hasChildren:!0,children:!1,key:!1,name:!1,update:!0,preDraw:!0,draw:!0,transform:!0,mouseEnter:!0,mouseExit:!0,mouseUp:!0,mouseDown:!0,mouseClick:!0},r=function(){this.components=[],this.onScreenNode=null,this.screenSort=[],this.hasChildren=!1,this.children=[],this.key="",this.name=""};r.prototype.matchData=function(t,i){if(!t||!i||t.constructor!==Object||i.constructor!==Object)return console.log("Error matching data.  Data obj or key map is falsy or not an Object."),!1;if(t.name&&(t.name.constructor===String?this.name=t.name:console.log("Error matching data.  Non-string name ignored.")),t.key&&(t.key.constructor===String?(this.key=t.key,i[t.key]=this):console.log("Error matching data.  Non-string key ignored.")),t.children)if(t.children.constructor===Array){var n=this;t.children.forEach(function(t){var e=new r;e.matchData(t,i)&&(n.hasChildren=!0,n.children.push(e))})}else console.log("Error matching data.  Non-array children ignored.");for(var o in t){if(e[o])return console.log("Error matching data. Data contains a runtime only property: "+o),!1;e.hasOwnProperty(o)||(this[o]?console.log("Error matching data.  Duplicate component type on entity not allowed: "+o):(this.components.push(o),this[o]=t[o]))}return!0},r.prototype.realize=function(t,e,r,i){if(!t||!e||t.constructor!==Object||e.constructor!==Object)return void console.log("Error realizing entity.  Key map or egg carton is falsy or not an Object.");var n=null,o=null,s=null,a=[],l=[],h=[],c=[],u=[],f=[],d=this;this.components.forEach(function(m){if(!e[m])return void console.log("Error realizing component.  No egg registered for type: "+m);var g=d[m],y=null!=g?g.data:null,p=null!=g?g.refs:null;if(null!=p&&p.constructor===Object)for(var v in p){var w=p[v];w&&w.constructor!==String?console.log("Error realizing component.  Referenced value is not a string."):t[w]?p[v]=t[w]:r&&r[w]?p[v]=r[w]:i&&i[w]?p[v]=i[w]:console.log("Error realizing component.  An entity with name: "+this.name+" references an entity for: "+v+" with missing key: "+w)}var S=e[m].create(y,p,d)||{};d[m]=S,S.transform&&S.transform.constructor===Function&&(n?console.log("Error realizing component.  Entity contains two eggs with transform functions.  Only one allowed.  Name: "+this.name+"  Key: "+this.key):n=S),S.preDraw&&S.preDraw.constructor===Function&&(o?console.log("Error realizing component.  Entity contains two eggs with preDraw functions.  Only one allowed.  Name: "+this.name+"  Key: "+this.key):o=S),S.draw&&S.draw.constructor===Function&&(s?console.log("Error realizing component.  Entity contains two eggs with draw functions.  Only one allowed.  Name: "+this.name+"  Key: "+this.key):s=S),S.update&&S.update.constructor===Function&&a.push(S),S.mouseEnter&&S.mouseEnter.constructor===Function&&l.push(S),S.mouseExit&&S.mouseExit.constructor===Function&&h.push(S),S.mouseUp&&S.mouseUp.constructor===Function&&u.push(S),S.mouseDown&&S.mouseDown.constructor===Function&&c.push(S),S.mouseClick&&S.mouseClick.constructor===Function&&f.push(S)}),n&&(this.transform=function(t){return n.transform(t)}),o&&s?(this.preDraw=function(t){return o.preDraw(t)},this.draw=function(){return s.draw()}):(o||s)&&console.log("Error realizing component.  Component must define both preDraw and draw, or neither."),a.length>0&&(this.update=function(t){a.forEach(function(e){e.update(t)})}),l.length>0&&(this.mouseEnter=function(){l.forEach(function(t){t.mouseEnter()})}),h.length>0&&(this.mouseExit=function(){h.forEach(function(t){t.mouseExit()})}),u.length>0&&(this.mouseUp=function(){u.forEach(function(t){t.mouseUp()})}),c.length>0&&(this.mouseDown=function(){c.forEach(function(t){t.mouseDown()})}),f.length>0&&(this.mouseClick=function(){f.forEach(function(t){t.mouseClick()})}),this.hasChildren&&this.children.forEach(function(n){n.realize(t,e,r,i)})},window.omelet.salt(null,function(e){e.realize=function(r,i){if(r)if(r.constructor===String)try{var n=JSON.parse(r);if(n.constructor===Array)return t(n,e.eggs,i);console.log("Error realizing data, input must be JSON representation of array.")}catch(o){console.log("Error realizing data.  JSON parse failed: "+o)}else console.log("Error realizing data.  Data Objects are not supported with prototypes of: "+r.constructor);else console.log("Error realizing data.  Falsy input cannot be realized.")}}),window.omelet.salt(null,function(t){t.checkIsEntity=function(t){return t&&t.constructor===r}})}(),function(){var t=function(t){var e=42,r=!1;this.camera={x:0,y:0,angle:0,zoom:1},this.assets={},this.layers={},this.the={},this.hierarchy=[],this.mousePosition=[0,0],this.mouseDown=!1,this.setLayers=function(t){if(t&&!t.constructor!==Object){for(var e in this.layers)delete this.layers[e];for(var e in t)if(t.hasOwnProperty(e)){var r=t[e];r&&r.constructor===Number&&(this.layers[e]=t[e])}}},this.addAssets=function(i){var n=t.realize(i,this);if(n){var o=this;n.forEach(function(t){var r=t.key||t.name;r&&!o.assets[r]||(r=e.toString(),e+=1),o.assets[r]=t});var o=this;r&&n.forEach(function(t){s(t,o)})}},this.addToThe=function(i){var n=t.realize(i,this);if(n){var o=this;n.forEach(function(t){var r=t.key||t.name;r&&!o.the[r]||(r=e.toString(),e+=1),o.the[r]=t});var o=this;r&&n.forEach(function(t){s(t,o)})}},this.addToHierarchy=function(e){var i=t.realize(e,this);if(i){var n=this;i.forEach(function(t){n.hierarchy.push(t)});var n=this;r&&i.forEach(function(t){s(t,n)})}},this.removeFromHierarchy=function(e){return t.checkIsEntity(e)?(n(e),i(this.hierarchy,e)?void 0:void console.log("Error removing entity from hierarchy.  Entity could not be found in this scene.")):void console.log("Error removing entity from hierarchy.  Argument entity is not of type OmeletEntity.")},this.clearHeirarchy=function(){for(this.hierarchy.forEach(n);this.hierarchy.count>0;)this.hierarchy.pop()},this.initialize=function(){if(!r){r=!0;for(var t in this.assets)s(this.assets[t],this);for(var t in this.the)s(this.the[t],this);var e=this;this.hierarchy.forEach(function(t){s(t,e)})}},this.update=function(t){for(var e in this.the){var r=this.the[e];o(r,t)}this.hierarchy.forEach(function(e){o(e,t)})};var i=function(t,e){for(var r=0;r<list.length;r++){if(t[r]===e)return t.splice(r,1),!0;if(t[r].hasChildren&&i(t[r].children,e))return!0}return!1},n=function(t){t.onScreenNode&&t.onScreenNode.remove(),t.hasChildren&&t.children.forEach(n)},o=function(t,e){t.update&&t.update(e),t.hasChildren&&t.children.forEach(function(t){o(t,e)})},s=function(t,e){t.components.forEach(function(r){var i=t[r];i.ready&&i.ready.constructor===Function&&i.ready(e,t)}),t.hasChildren&&t.children.forEach(function(t){s(t,e)})}};window.omelet.salt("createEmptyScene",function(e){return function(){return new t(e)}}),window.omelet.salt(null,function(e){e.checkIsScene=function(e){return e&&e.constructor===t}})}(),function(){window.omelet.salt("makeGame",function(t){return function(e,r){if(!e||e.constructor!=HTMLCanvasElement)return void console.log("Error making game.  Canvas Element must be non-null object of type HTMLCanvasElement.");if(!t.checkIsScene(r))return void console.log("Error making game. Scene object must be non-null object of type Scene.");var i=e.getContext("2d"),n=i.width,o=i.height,s=[],a=t.wrapContext(i),l=t.createOnScreenTree(),h=[-10,-10],c=!1,u=!1,f=null,d=null,m=!1,g=0,y=r.camera,p=(r.assets,r.the,r.hierarchy);e.addEventListener("mousedown",function(t){c=!0}),e.addEventListener("mouseup",function(t){c=!1}),e.addEventListener("mousemove",function(t){var r=e.getBoundingClientRect();h=[t.clientX-r.left,t.clientY-r.top]}),r.Context=i;var v=function(e){if(a.save(),e.transform)var r=e.transform(a);if(e.preDraw){var i=e.preDraw(r||a.getSnapshot());t.testIntersection(s,i)?e.onScreenNode||l.insert(e):e.onScreenNode&&e.onScreenNode.remove()}e.hasChildren&&e.children.forEach(v),a.restore()},w=function(e){for(r.mousePosition=h,r.mouseDown=c;e.length>0;){var i=e.pop(),n=h[0],o=h[1];if(t.testPointInPolygon(n,o,i.box))return f!=i.entity&&(d=null,f&&f.mouseExit&&f.mouseExit(),f=i.entity,f.mouseEnter&&f.mouseEnter()),void(u!=c&&(c?d=h.slice():(d&&Math.sqrt(Math.pow(d[0]-h[0],2)+Math.pow(d[1]-h[1],2))<20&&f.mouseClick&&f.mouseClick(),d=null),c&&f.mouseDown?f.mouseDown():!c&&f.mouseUp&&f.mouseUp(),u=c))}f&&f.mouseExit&&f.mouseExit(),f=null,u=c},S=function(t){if(n=e.width,o=e.height,s=[[0,0],[n,0],[n,o],[0,o]],!t){var h=(new Date).getTime(),c=(h-(g||h))/1e3;c>1&&(c=.016),g=h,r.update(c)}a.setRect([0,0,n,o]),a.save(),a.translate(n/2,o/2),a.translate(-1*y.x,-1*y.y),0!=y.angle&&a.rotate(-1*y.angle),a.scale(y.zoom,y.zoom),p.forEach(v),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,n,o);var u=l.draw();u&&u.length>0&&w(u),a.restore(),m&&window.requestAnimationFrame(S)};return r.initialize(),{start:function(){m||(m=!0,window.requestAnimationFrame(S))},stop:function(){m=!1},doFrameSkipUpdate:function(){m=!1,S(!0)}}}})}(),omelet.egg("omelet.sprites.spriteRenderer",function(t,e){this.spriteName=t.spriteName;var r=null,i=null,n=null;this.ready=function(r,i){i.screenSort=[r.layers[t.layer]||0,t.orderInLayer],n=e.spriteSheet["omelet.sprites.spriteSheet"]},this.preDraw=function(t){if(r=t,i=[],!n||!n.loaded)return i;var e=n.sprites[this.spriteName];return e?(i.push(t.transformPoint(-1*e.pivotX,-1*e.pivotY)),i.push(t.transformPoint(e.width-e.pivotX,-1*e.pivotY)),i.push(t.transformPoint(e.width-e.pivotX,e.height-e.pivotY)),i.push(t.transformPoint(-1*e.pivotX,e.height-e.pivotY)),i):i},this.draw=function(){var t=r.getContext(),e=n.sprites[this.spriteName];return t.drawImage(n.image,e.x,e.y,e.width,e.height,-1*e.pivotX,-1*e.pivotY,e.width,e.height),i}}).defaults({spriteName:"Default",layer:"default",orderInLayer:0}).references({spriteSheet:"omelet.sprites.spriteSheet"}),omelet.egg("omelet.sprites.spriteSheet",function(t,e){this.image=new Image,this.sprites=t.sprites,this.loaded=!1;var r=this;this.image.addEventListener("load",function(){r.loaded=!0}),this.image.src=t.src}).defaults({src:"./Omelet.png",sprites:{Default:{x:0,y:0,width:400,height:400,pivotX:200,pivotY:200}}}),omelet.egg("omelet.shapes.polygon",function(t,e){}).defaults({}).references({}).requires([]),omelet.egg("omelet.shapes.rectangle",function(t,e){this.fillStyle=t.fillStyle,this.strokeStyle=t.strokeStyle,this.width=t.width,this.height=t.height;var r=0,i=0,n=null,o=null;this.ready=function(e,r){r.screenSort=[e.layers[t.layer]||0,t.orderInLayer]},this.preDraw=function(t){return n=t,o=[],r=this.width/2,i=this.height/2,o.push(t.transformPoint(-1*r,-1*i)),o.push(t.transformPoint(r,-1*i)),o.push(t.transformPoint(r,i)),o.push(t.transformPoint(-1*r,i)),o},this.draw=function(){if(n){var t=n.getContext();return this.fillStyle&&(t.fillStyle=this.fillStyle,t.fillRect(-1*r,-1*i,this.width,this.height)),this.strokeStyle&&(t.strokeStyle=this.strokeStyle,t.strokeRect(-1*r,-1*i,this.width,this.height)),o}}}).defaults({fillStyle:null,strokeStyle:null,width:15,height:15,layer:"default",orderInLayer:0}),omelet.egg("omelet.ui.circle",function(t,e){this.fillStyle=t.fillStyle,this.strokeStyle=t.strokeStyle,this.strokeWidth=t.strokeWidth,this.hitTarget=t.hitTarget,this.shadowDistance=t.shadowDistance,this.shadowColor=t.shadowColor;var r,i,n,o=null,s=null;this.ready=function(e,r){r.screenSort=[e.layers[t.layer]||0,t.orderInLayer]},this.preDraw=function(t){o=t;var e=t.getRect(),a=e[0],l=e[1],h=e[2],c=e[3],u=c>h?h:c;h>u?a+=(h-u)/2:c>u&&(l+=(c-u)/2),n=u/2,r=a+n,i=l+n,s=[];for(var f=0;f<2*Math.PI;f+=Math.PI/5)s.push([r+n*Math.cos(f),i+n*Math.sin(f)]);return s},this.draw=function(t){if(o){t||0==this.shadowDistance||this.draw(!0);var e=o.getIdentityContext(),a=t?r+this.shadowDistance:r,l=t?i+this.shadowDistance:i;e.beginPath(),e.arc(a,l,n,0,2*Math.PI),e.closePath();var h=t?this.shadowColor:this.fillStyle;return h&&(e.fillStyle=h,e.fill()),!t&&this.strokeStyle&&(e.lineWidth=this.strokeWidth,e.strokeStyle=this.strokeStyle,e.stroke()),this.hitTarget?s:void 0}}}).defaults({fillStyle:null,strokeStyle:null,strokeWidth:1,layer:"default",orderInLayer:0,hitTarget:!0,shadowDistance:0,shadowColor:"rgba(0, 0, 0, .3)"}),omelet.egg("omelet.ui.pillRectangle",function(t,e){this.fillStyle=t.fillStyle,this.strokeStyle=t.strokeStyle,this.strokeWidth=t.strokeWidth,this.hitTarget=t.hitTarget,this.shadowDistance=t.shadowDistance,this.shadowColor=t.shadowColor;var r,i,n,o,s,a,l,h=null,c=null,u=null;this.ready=function(e,r){r.screenSort=[e.layers[t.layer]||0,t.orderInLayer]},this.preDraw=function(t){h=t;var e=t.getRect();i=e[1],a=e[3],o=i+a,l=.5*a;var u=i+l;if(s=e[2],s-=a,0>s){s=0;var f=e[0]+.5*e[2];r=f,n=f,c=[[f,i],[f+l,u],[f,o],[f-l,u]]}else r=e[0]+l,n=r+s,c=[[r,i],[n,i],[n+l,u],[n,o],[r,o],[r-l,u]];return c},this.draw=function(t){if(h){t||0==this.shadowDistance||this.draw(!0);var e=h.getIdentityContext();if(t&&e.translate(this.shadowDistance,this.shadowDistance),e.beginPath(),e.moveTo(r,i),e.lineTo(n,i),e.arcTo(n+l,i,n+l,i+l,l),e.arcTo(n+l,o,n,o,l),e.lineTo(r,o),e.arcTo(r-l,o,r-l,i+l,l),e.arcTo(r-l,i,r,i,l),e.closePath(),t)e.fillStyle=this.shadowColor,e.fill();else if(this.fillStyle){if(this.fillStyle.constructor===String)e.fillStyle=this.fillStyle;else if(u&&u.startPoint==i&&u.endPoint==o&&u.topColor==this.fillStyle.top&&u.bottomColor==this.fillStyle.bottom)e.fillStyle=u.gradient;else{var s=e.createLinearGradient(0,i,0,o);s.addColorStop(0,this.fillStyle.top),s.addColorStop(1,this.fillStyle.bottom),u={gradient:s,startPoint:i,endPoint:o,topColor:this.fillStyle.top,bottomColor:this.fillStyle.bottom},e.fillStyle=s}e.fill()}return this.strokeStyle&&(e.lineWidth=this.strokeWidth,e.strokeStyle=this.strokeStyle,e.stroke()),this.hitTarget?c:void 0}}}).defaults({fillStyle:null,strokeStyle:null,strokeWidth:1,layer:"default",orderInLayer:0,hitTarget:!0,shadowDistance:0,shadowColor:"rgba(0, 0, 0, .3)"}),omelet.egg("omelet.ui.rectangle",function(t,e){this.fillStyle=t.fillStyle,this.strokeStyle=t.strokeStyle,this.strokeWidth=t.strokeWidth,this.cornerRadius=t.cornerRadius,this.hitTarget=t.hitTarget,this.shadowDistance=t.shadowDistance,this.shadowColor=t.shadowColor;var r,i,n,o,s,a,l,h=null,c=null;this.ready=function(e,r){r.screenSort=[e.layers[t.layer]||0,t.orderInLayer]},this.preDraw=function(t){h=t;var e=t.getRect();return r=e[0],i=e[1],s=e[2],a=e[3],n=r+s,o=i+a,c=[[r,i],[n,i],[n,o],[r,o]]},this.draw=function(t){if(h){t||0==this.shadowDistance||this.draw(!0);var e=h.getIdentityContext();if(t&&e.translate(this.shadowDistance,this.shadowDistance),e.beginPath(),e.moveTo(r,i),e.lineTo(n,i),e.lineTo(n,o),e.lineTo(r,o),e.lineTo(r,i),e.closePath(),t)e.fillStyle=this.shadowColor,e.fill();else if(this.fillStyle){if(this.fillStyle.constructor===String)e.fillStyle=this.fillStyle;else if(l&&l.startPoint==i&&l.endPoint==o&&l.topColor==this.fillStyle.top&&l.bottomColor==this.fillStyle.bottom)e.fillStyle=l.gradient;else{var s=e.createLinearGradient(0,i,0,o);s.addColorStop(0,this.fillStyle.top),s.addColorStop(1,this.fillStyle.bottom),l={gradient:s,startPoint:i,endPoint:o,topColor:this.fillStyle.top,bottomColor:this.fillStyle.bottom},e.fillStyle=s}e.fill()}return this.strokeStyle&&(e.lineWidth=this.strokeWidth,e.strokeStyle=this.strokeStyle,e.stroke()),this.hitTarget?c:void 0}}}).defaults({fillStyle:null,strokeStyle:null,strokeWidth:1,layer:"default",orderInLayer:0,hitTarget:!0,shadowDistance:0,shadowColor:"rgba(0, 0, 0, .3)"}),omelet.egg("omelet.ui.roundedRectangle",function(t,e){this.fillStyle=t.fillStyle,this.strokeStyle=t.strokeStyle,this.strokeWidth=t.strokeWidth,this.cornerRadius=t.cornerRadius,this.hitTarget=t.hitTarget,this.shadowDistance=t.shadowDistance,this.shadowColor=t.shadowColor;var r,i,n,o,s,a,l,h=null,c=null;this.ready=function(e,r){r.screenSort=[e.layers[t.layer]||0,t.orderInLayer]},this.preDraw=function(t){h=t;var e=t.getRect();return r=e[0],i=e[1],s=e[2],a=e[3],n=r+s,o=i+a,c=[[r,i],[n,i],[n,o],[r,o]]},this.draw=function(t){if(h){t||0==this.shadowDistance||this.draw(!0);var e=this.cornerRadius;e>.5*s&&(e=.5*s),e>.5*a&&(e=.5*a);var u=h.getIdentityContext();if(t&&u.translate(this.shadowDistance,this.shadowDistance),u.beginPath(),u.moveTo(r+e,i),u.lineTo(n-e,i),u.arcTo(n,i,n,i+e,e),u.lineTo(n,o-e),u.arcTo(n,o,n-e,o,e),u.lineTo(r+e,o),u.arcTo(r,o,r,o-e,e),u.lineTo(r,i+e),u.arcTo(r,i,r+e,i,e),u.closePath(),t)u.fillStyle=this.shadowColor,u.fill();else if(this.fillStyle){if(this.fillStyle.constructor===String)u.fillStyle=this.fillStyle;else if(l&&l.startPoint==i&&l.endPoint==o&&l.topColor==this.fillStyle.top&&l.bottomColor==this.fillStyle.bottom)u.fillStyle=l.gradient;else{var f=u.createLinearGradient(0,i,0,o);f.addColorStop(0,this.fillStyle.top),f.addColorStop(1,this.fillStyle.bottom),l={gradient:f,startPoint:i,endPoint:o,topColor:this.fillStyle.top,bottomColor:this.fillStyle.bottom},u.fillStyle=f}u.fill()}return this.strokeStyle&&(u.lineWidth=this.strokeWidth,u.strokeStyle=this.strokeStyle,u.stroke()),this.hitTarget?c:void 0}}}).defaults({fillStyle:null,strokeStyle:null,strokeWidth:1,cornerRadius:10,layer:"default",orderInLayer:0,hitTarget:!0,shadowDistance:0,shadowColor:"rgba(0, 0, 0, .3)"}),omelet.egg("omelet.ui.spriteRenderer",function(t,e){this.spriteName=t.spriteName,this.maintainAspect=t.maintainAspect,this.hitTarget=t.hitTarget;var r,i,n,o,s,a,l;this.ready=function(r,i){i.screenSort=[r.layers[t.layer]||0,t.orderInLayer],l=e.spriteSheet["omelet.sprites.spriteSheet"]},this.preDraw=function(t){s=t;var e=t.getRect();if(a=[],!l||!l.loaded)return a;var h=l.sprites[this.spriteName];if(!h)return a;if(r=e[0],i=e[1],n=e[2],o=e[3],this.maintainAspect&&h.height>0){var c=h.width/h.height,u=h.height,f=h.width;f>n&&(f=n,u=n/c),u>o&&(u=o,f=u*c),n>f?(r+=(n-f)/2,n=f):o>u&&(i+=(o-u)/2,o=u)}var d=r+n,m=i+o;return a=[[r,i],[d,i],[d,m],[r,m]]},this.draw=function(){var t=s.getIdentityContext(),e=l.sprites[this.spriteName];return t.drawImage(l.image,e.x,e.y,e.width,e.height,r,i,n,o),this.hitTarget?a:void 0}}).defaults({spriteName:"Default",maintainAspect:!1,hitTarget:!0,layer:"default",orderInLayer:0}).references({spriteSheet:"omelet.sprites.spriteSheet"}),function(){var t=document.createElement("canvas"),e=t.getContext("2d");omelet.egg("omelet.ui.textRenderer",function(r,i){this.text=r.text,this.color=r.color,this.font=r.font,this.lineHeight=r.lineHeight,this.align=r.align;var n=null,o=0,s=0,a=0,l=0,h=new Image,c=null;this.ready=function(t,e){e.screenSort=[t.layers[r.layer]||0,r.orderInLayer]},this.preDraw=function(t){n=t;var e=t.getRect();o=e[0],s=e[1],a=e[2],l=e[3];var r=o+a,i=s+l;return[[o,s],[r,s],[r,i],[o,i]]},this.draw=function(){c&&c.width==a&&c.height==l&&c.text==this.text&&c.color==this.color&&c.font==this.font&&c.lineHeight==this.lineHeight&&c.align==this.align||(c={width:a,height:l,text:this.text,color:this.color,font:this.font,lineHeight:this.lineHeight,align:this.align},u(c));var t=n.getIdentityContext();t.drawImage(h,o,s)};var u=function(r,i){t.width=r.width,t.height=r.height,e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,a,l),i?e.scale(i,i):i=1;var n=r.width/i,o=r.height/i;e.font=r.font,e.textBaseline="middle",e.textAlign=r.align,e.fillStyle=r.color;for(var s=r.text||"",c=s.split(" "),f=[],d="",m=0;m<c.length;){var g=d+" "+c[m],y=e.measureText(g);y.width>n?(""!=d&&f.push(d),d=c[m]):d=g,m+=1}f.push(d);var p=f.length*r.lineHeight;if(p>o&&0!=o){var v=.5*i,w=o/p;return w>.5&&(v=w*i),void u(r,v)}var S=(o-p+r.lineHeight)/2,k="left"==r.align?0:"right"==r.align?r.width:n/2;f.forEach(function(t){e.fillText(t,k,S,n),S+=r.lineHeight}),h.width=r.width,h.height=r.height,h.src=t.toDataURL()}}).defaults({text:"New Text",color:"black",font:"30px sans-serif",lineHeight:35,align:"center",layer:"default",orderInLayer:0})}(),omelet.egg("omelet.rectTransform",function(t,e){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom,this.offsetLeft=t.offsetLeft,this.offsetTop=t.offsetTop,this.offsetRight=t.offsetRight,this.offsetBottom=t.offsetBottom,this.transform=function(t){var e=t.getRect(),r=this.left*e[2]+this.offsetLeft,i=this.top*e[3]+this.offsetTop,n=this.right*e[2]-this.offsetRight-r,o=this.bottom*e[3]-this.offsetBottom-i;e=[e[0]+r,e[1]+i,n,o],t.setRect(e)}}).defaults({left:0,top:0,right:1,bottom:1,offsetLeft:10,offsetTop:10,offsetRight:10,offsetBottom:10}),omelet.egg("omelet.transform",function(t,e){this.x=t.x,this.y=t.y,this.angle=t.angle;var r=null;this.transform=function(t){return t.translate(this.x,this.y),t.rotate(this.angle),r=t.getSnapshot()},this.getPosition=function(){return r?r.transformPoint(0,0):[0,0]},this.setPosition=function(t,e){var i=r?r.inverseTransformInParentSpace(t,e):[t,e];this.x=i[0],this.y=i[1]}}).defaults({x:0,y:0,angle:0});
//# sourceMappingURL=omelet.min.js.map